install.packages('faraway')
#install.packages('faraway')
library(faraway)
library(faraway)
data(gavote)
help(gavote)
# introducing the data
head(gavote)
str(gavote)
summary(gavote)
gavote$undercount=(gavote$ballots-gavote$votes)/gavote$ballots
summary(gavote$undercount)
plot(gavote$perAA,gavote$undercount)
# not the same as
with(gavote,sum(ballots-votes)/sum(ballots))
hist(gavote$undercount, main='Undercount',xlab='Proportion Undercount')
hist(gavote$undercount, main='Undercount',xlab='Proportion Undercount',breaks=20)
hist(gavote$undercount, main='Undercount',xlab='Proportion Undercount')
hist(gavote$undercount, main='Undercount',xlab='Proportion Undercount',breaks=20)
pie(table(gavote$equip))
barplot(sort(table(gavote$equip),decreasing=TRUE),las=2)
avote$pergore = gavote$gore/gavote$votes
gavote$pergore = gavote$gore/gavote$votes
plot(pergore ~ perAA, gavote, xlab='Proportion African Americans',ylab='Proportion for Gore')
plot(undercount~equip, gavote, xlab='', las=3)
xtabs(~atlanta+rural,gavote)
# added
xtabs(~atlanta+rural+equip,gavote)
names(gavote)[4]='usage'
nix=c(3,10,11,12)
cor(gavote[,nix])
lmod=lm(undercount~pergore+perAA,gavote)
coef(lmod)
summary(lmod)
predict(lmod)
residuals(lmod)
predict(lmod,se.fit=T)
deviance(lmod)
df.residual(lmod)
nrow(gavote)-length(coef(lmod))
sqrt(deviance(lmod)/df.residual(lmod))
lmodsum=summary(lmod)
lmodsum$sigma
lmodsum$r.squared
cor(predict(lmod),gavote$undercount)^2
lmodsum$adj.r.squared
?deviance
gavote$cpergore=gavote$pergore-mean(gavote$pergore)
gavote$cperAA=gavote$perAA-mean(gavote$perAA)
lmodi=lm(undercount~cperAA+cpergore*usage+equip,gavote)
summary(lmodi)
anova(lmod,lmodi)
anova(lmod,lmodi)
drop1(lmodi,test='F')
confint(lmodi)
plot(lmodi)
sumary(lmod)
Y=read.csv('C:/Users/rsmith/jan16/UNC/STOR556/Data/ProportionNotReturned.csv',header=T)
Y=read_csv("~/FILES/UNC Course/STOR Major/STOR 590/04 Homeworks/Homework 1/ProportionNotReturned.csv")
library(readr)
Y=read_csv("~/FILES/UNC Course/STOR Major/STOR 590/04 Homeworks/Homework 1/ProportionNotReturned.csv")
hist(Y$PNR,main='Proportion Absentee Ballots Not Returned - NC Nov 2018')
plot(density(Y$PNR),main='Proportion Absentee Ballots Not Returned - NC Nov 2018')
rug(Y$PNR)
wts=Y$PNR<0.1
# example of a plausible linear model (not the solution to HW1)
lm1=lm(Y$PNR~Y$Hsgrad+Y$Collgrad,weights=as.numeric(wts))
# note use of "as.numeric" to turn wts into a numerical variable
predict(lm1,se.fit=T)
install.packages("generalhoslem")
